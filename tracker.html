<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strategy Tracker - Road Ranger</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: subpixel-antialiased;
            -moz-osx-font-smoothing: auto;
            text-rendering: geometricPrecision;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #606060;
            --accent: #00ff88;
            --accent-dim: #00cc6a;
            --border: #333333;
            --shadow: rgba(0, 255, 136, 0.1);
        }

        body {
            font-family: 'Crimson Pro', serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: grid;
            grid-template-columns: 400px 1fr;
            height: 100vh;
        }

        /* LEFT PANEL */
        .left-panel {
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            padding: 2rem;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;
            font-size: 1.75rem;
            font-weight: 700;
            letter-spacing: 0;
            margin-bottom: 0.5rem;
            color: var(--accent);
            transform: translateZ(0);
            will-change: transform;
        }

        .subtitle {
            font-size: 0.875rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;
        }

        .stats {
            display: flex;
            gap: 1.5rem;
            padding: 1rem 2rem;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;
            font-size: 0.75rem;
        }

        .stat {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .stat-label {
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat-value {
            color: var(--accent);
            font-size: 2.5rem;
            font-weight: 700;
            transform: translateZ(0);
            will-change: transform;
        }

        .search-container {
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-primary);
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--shadow);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .stores-list {
            flex: 1;
            overflow-y: auto;
            padding: 1rem 0;
        }

        .store-item {
            padding: 1rem 2rem;
            cursor: pointer;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }

        .store-item:hover {
            background: var(--bg-tertiary);
            border-left-color: var(--text-muted);
        }

        .store-item.active {
            background: var(--bg-tertiary);
            border-left-color: var(--accent);
        }

        .store-item.has-notes::after {
            content: '';
            width: 6px;
            height: 6px;
            background: var(--accent);
            border-radius: 50%;
            position: absolute;
            right: 2rem;
        }

        .store-name {
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;
            font-size: 0.875rem;
            font-weight: 700;
        }

        .store-item.hidden {
            display: none;
        }

        .footer {
            padding: 1rem 2rem;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            flex: 1;
            padding: 0.75rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 4px;
        }

        .btn:hover {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        /* RIGHT PANEL */
        .right-panel {
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        #editor-view {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .editor-header {
            padding: 2rem;
            border-bottom: 1px solid var(--border);
            background: rgba(0, 255, 136, 0.02);
        }

        .editor-title {
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--accent);
        }

        .editor-meta {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .editor-container {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.3);
            border-top: 1px solid var(--border);
        }

        .editor {
            width: 100%;
            height: 100%;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-family: 'Crimson Pro', serif;
            font-size: 1.4rem;
            line-height: 2.1;
            padding: 0.5rem;
            resize: none;
            outline: none;
        }

        .editor::placeholder {
            color: var(--text-muted);
            font-style: italic;
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 2rem;
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }

        .empty-title {
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .empty-text {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .save-indicator {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 0.75rem 1.5rem;
            background: var(--accent);
            color: var(--bg-primary);
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Courier New', monospace;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-radius: 4px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.1s ease;
            pointer-events: none;
        }

        .save-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        /* ANIMATIONS */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .store-item {
            animation: fadeIn 0.3s ease;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }

            .right-panel {
                display: none;
            }

            .right-panel.mobile-active {
                display: flex;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                z-index: 100;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- LEFT PANEL -->
        <div class="left-panel">
            <div class="header">
                <div class="logo">STRATEGY TRACKER</div>
                <div class="subtitle">Road Ranger Stations</div>
            </div>

            <div class="stats">
                <div class="stat">
                    <div class="stat-label">Total</div>
                    <div class="stat-value" id="total-count">55</div>
                </div>
                <div class="stat">
                    <div class="stat-label">With Notes</div>
                    <div class="stat-value" id="notes-count">0</div>
                </div>
            </div>

            <div class="search-container">
                <input 
                    type="text" 
                    class="search-input" 
                    id="search-input" 
                    placeholder="Search stores..."
                    autocomplete="off"
                >
            </div>

            <div class="stores-list" id="stores-list"></div>

            <div class="footer">
                <button class="btn" id="export-btn">Export All</button>
                <button class="btn" id="import-btn">Import</button>
                <button class="btn" id="clear-btn">Clear All</button>
            </div>
            
            <input type="file" id="import-file" accept=".json" style="display: none;">
        </div>

        <!-- RIGHT PANEL -->
        <div class="right-panel" id="right-panel">
            <div id="empty-state" class="empty-state">
                <div class="empty-icon"></div>
                <div class="empty-title">Select a Store</div>
                <div class="empty-text">Choose a store from the list to view and edit notes</div>
            </div>

            <div id="editor-view" style="display: none;">
                <div class="editor-header">
                    <div class="editor-title" id="editor-title"></div>
                    <div class="editor-meta" id="editor-meta"></div>
                </div>
                <div class="editor-container">
                    <textarea 
                        class="editor" 
                        id="editor" 
                        placeholder="Start typing your strategy notes here..."
                    ></textarea>
                </div>
            </div>
        </div>
    </div>

    <div class="save-indicator" id="save-indicator">Saved</div>

    <script>
        // Store data
        const stores = ["Road Ranger 118","Road Ranger 132","Road Ranger 136","Road Ranger 139","Road Ranger 140","Road Ranger 141","Road Ranger 144","Road Ranger 145","Road Ranger 153","Road Ranger 157","Road Ranger 181","Road Ranger 185","Road Ranger 186","Road Ranger 187","Road Ranger 203","Road Ranger 205","Road Ranger 206","Road Ranger 209","Road Ranger 210","Road Ranger 211","Road Ranger 225","Road Ranger 226","Road Ranger 235","Road Ranger 236","Road Ranger 240","Road Ranger 242","Road Ranger 263","Road Ranger 265","Road Ranger 266","Road Ranger 267","Road Ranger 268","Road Ranger 269","Road Ranger 270","Road Ranger 271","Road Ranger 272","Road Ranger 273","Road Ranger 275","Road Ranger 276","Road Ranger 277","Road Ranger 278","Road Ranger 279","Road Ranger 280","Road Ranger 281","Road Ranger 282","Road Ranger 283","Road Ranger 284","Road Ranger 285","Road Ranger 286","Road Ranger 287","Road Ranger 289","Road Ranger 290","Road Ranger 312","Road Ranger 315","Road Ranger 319","Road Ranger 323"];

        // State
        let currentStore = null;
        let saveTimeout = null;

        // DOM elements
        const storesList = document.getElementById('stores-list');
        const searchInput = document.getElementById('search-input');
        const editor = document.getElementById('editor');
        const editorView = document.getElementById('editor-view');
        const emptyState = document.getElementById('empty-state');
        const editorTitle = document.getElementById('editor-title');
        const editorMeta = document.getElementById('editor-meta');
        const saveIndicator = document.getElementById('save-indicator');
        const totalCount = document.getElementById('total-count');
        const notesCount = document.getElementById('notes-count');
        const exportBtn = document.getElementById('export-btn');
        const importBtn = document.getElementById('import-btn');
        const importFile = document.getElementById('import-file');
        const clearBtn = document.getElementById('clear-btn');

        // Initialize
        function init() {
            renderStores();
            updateStats();
            setupEventListeners();
        }

        // Render stores list
        function renderStores() {
            storesList.innerHTML = '';
            stores.forEach(store => {
                const storeItem = document.createElement('div');
                storeItem.className = 'store-item';
                storeItem.dataset.store = store;
                
                const notes = getStoreNotes(store);
                if (notes && notes.trim()) {
                    storeItem.classList.add('has-notes');
                }

                storeItem.innerHTML = `<div class="store-name">${store}</div>`;
                storeItem.addEventListener('click', () => selectStore(store));
                storesList.appendChild(storeItem);
            });
        }

        // Select store
        function selectStore(store) {
            currentStore = store;
            
            // Update active state
            document.querySelectorAll('.store-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.store === store) {
                    item.classList.add('active');
                }
            });

            // Load notes
            const notes = getStoreNotes(store);
            editor.value = notes || '';

            // Update UI
            emptyState.style.display = 'none';
            editorView.style.display = 'flex';
            editorTitle.textContent = store;
            updateEditorMeta();

            // Focus editor
            editor.focus();

            // Mobile: show right panel
            if (window.innerWidth <= 768) {
                document.getElementById('right-panel').classList.add('mobile-active');
            }
        }

        // Get store notes from localStorage
        function getStoreNotes(store) {
            const key = `rr-strategy-${store}`;
            const data = localStorage.getItem(key);
            if (data) {
                try {
                    const parsed = JSON.parse(data);
                    return parsed.notes;
                } catch (e) {
                    return data; // Fallback for old format
                }
            }
            return '';
        }

        // Save store notes to localStorage
        function saveStoreNotes(store, notes) {
            const key = `rr-strategy-${store}`;
            const data = {
                notes: notes,
                lastUpdated: new Date().toISOString()
            };
            localStorage.setItem(key, JSON.stringify(data));
            
            // Update visual indicators
            const storeItem = document.querySelector(`.store-item[data-store="${store}"]`);
            if (notes && notes.trim()) {
                storeItem.classList.add('has-notes');
            } else {
                storeItem.classList.remove('has-notes');
            }
            
            updateStats();
            updateEditorMeta();
            showSaveIndicator();
        }

        // Update editor meta
        function updateEditorMeta() {
            if (!currentStore) return;
            
            const key = `rr-strategy-${currentStore}`;
            const data = localStorage.getItem(key);
            if (data) {
                try {
                    const parsed = JSON.parse(data);
                    if (parsed.lastUpdated) {
                        const date = new Date(parsed.lastUpdated);
                        editorMeta.textContent = `Last updated: ${formatDate(date)}`;
                        return;
                    }
                } catch (e) {}
            }
            editorMeta.textContent = 'Last updated: Never';
        }

        // Format date
        function formatDate(date) {
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);

            if (minutes < 1) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;
            if (hours < 24) return `${hours}h ago`;
            if (days < 7) return `${days}d ago`;
            
            return date.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric', 
                year: 'numeric' 
            });
        }

        // Show save indicator
        function showSaveIndicator() {
            saveIndicator.classList.add('show');
            setTimeout(() => {
                saveIndicator.classList.remove('show');
            }, 1000);
        }

        // Update stats
        function updateStats() {
            let withNotes = 0;
            stores.forEach(store => {
                const notes = getStoreNotes(store);
                if (notes && notes.trim()) {
                    withNotes++;
                }
            });
            
            totalCount.textContent = stores.length;
            notesCount.textContent = withNotes;
        }

        // Search stores
        function searchStores(query) {
            const lowerQuery = query.toLowerCase();
            document.querySelectorAll('.store-item').forEach(item => {
                const storeName = item.dataset.store.toLowerCase();
                if (storeName.includes(lowerQuery)) {
                    item.classList.remove('hidden');
                } else {
                    item.classList.add('hidden');
                }
            });
        }

        // Export all notes
        function exportAllNotes() {
            const allNotes = {};
            stores.forEach(store => {
                const notes = getStoreNotes(store);
                if (notes && notes.trim()) {
                    allNotes[store] = notes;
                }
            });

            const dataStr = JSON.stringify(allNotes, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `road-ranger-strategy-notes-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        // Clear all notes
        function clearAllNotes() {
            if (!confirm('Are you sure you want to clear all notes? This cannot be undone.')) {
                return;
            }

            stores.forEach(store => {
                const key = `rr-strategy-${store}`;
                localStorage.removeItem(key);
            });

            editor.value = '';
            renderStores();
            updateStats();
            alert('All notes cleared successfully.');
        }

        // Import notes from JSON file
        function importNotes(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const imported = JSON.parse(e.target.result);
                    let importedCount = 0;

                    Object.entries(imported).forEach(([store, notes]) => {
                        const key = `rr-strategy-${store}`;
                        const data = {
                            notes: notes,
                            lastUpdated: new Date().toISOString()
                        };
                        localStorage.setItem(key, JSON.stringify(data));
                        importedCount++;
                    });

                    renderStores();
                    updateStats();
                    alert(`Successfully imported ${importedCount} store notes!`);
                } catch (error) {
                    alert('Error importing file. Please make sure it\'s a valid JSON export file.');
                }
            };
            reader.readAsText(file);
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search
            searchInput.addEventListener('input', (e) => {
                searchStores(e.target.value);
            });

            // Editor auto-save
            editor.addEventListener('input', () => {
                if (!currentStore) return;
                
                clearTimeout(saveTimeout);
                saveTimeout = setTimeout(() => {
                    saveStoreNotes(currentStore, editor.value);
                }, 300);
            });

            // Import
            importBtn.addEventListener('click', () => {
                importFile.click();
            });

            importFile.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    importNotes(e.target.files[0]);
                    // Reset file input so same file can be selected again
                    importFile.value = '';
                }
            });

            // Export
            exportBtn.addEventListener('click', exportAllNotes);

            // Clear
            clearBtn.addEventListener('click', clearAllNotes);

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                // ESC to deselect (mobile)
                if (e.key === 'Escape' && window.innerWidth <= 768) {
                    document.getElementById('right-panel').classList.remove('mobile-active');
                }

                // Ctrl/Cmd + S to save
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    if (currentStore) {
                        saveStoreNotes(currentStore, editor.value);
                    }
                }
            });
        }

        // Initialize app
        init();
    </script>
</body>
</html>
